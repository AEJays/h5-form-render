{"remainingRequest":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace2015\\sport\\wc-project\\h5-form-render\\src\\views\\parser\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\src\\views\\parser\\index.vue","mtime":1623743340123},{"path":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace2015\\sport\\wc-project\\h5-form-render\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgUGFyc2VyIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvUGFyc2VyJw0KaW1wb3J0IFByZXZpZXcgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9QcmV2aWV3Jw0KaW1wb3J0IHsgdXJsUGFyYW0sIEJhc2U2NCB9IGZyb20gJ0AvdXRpbHMnDQovLyBpbXBvcnQgeyBjb25maWcgfSBmcm9tICdAL2NvbmZpZycNCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycNCmltcG9ydCBjbG9uZURlZXAgZnJvbSAnbG9kYXNoLmNsb25lZGVlcCcNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0g1Rm9ybVJlbmRlcicsDQogIHByb3BzOiB7DQogICAgLy8g6KGo5Y2VaWQNCiAgICBhcmdGb3JtSWQ6IFN0cmluZywNCiAgICAvLyDooajljZXmlbDmja5pZA0KICAgIGFyZ0RhdGFJZDogU3RyaW5nLA0KICAgIC8vIOihqOWNleaVsOaNrg0KICAgIGFyZ0Zvcm1EYXRhOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICBkZWZhdWx0ICgpIHsNCiAgICAgICAgcmV0dXJuIG51bGwNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOaYr+WQpuaJi+WKqOaPkOS6pA0KICAgIGlmTWFudWFsU3VibWl0OiBCb29sZWFuLA0KICAgIGFyZ01vZDogU3RyaW5nLCAvLyDpu5jorqTnvJbovpEgZWRpdDog57yW6L6RICBwcmV2aWV3OiDpooTop4gNCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIFBhcnNlciwNCiAgICBQcmV2aWV3DQogIH0sDQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICBjb25maWc6IHt9LA0KICAgICAgZm9ybUluZm86IHt9LA0KICAgICAgZm9ybURhdGE6IHt9LA0KICAgICAgbW9kOiAnZWRpdCcNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQgKCkgew0KICAgIHRoaXMuaW5pdERhdGEoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaW5pdERhdGEgKCkgew0KICAgICAgY29uc3QgZm9ybUlkID0gdGhpcy5hcmdGb3JtSWQgfHwgdXJsUGFyYW0oJ2lkJykNCiAgICAgIGNvbnN0IGRhdGFJZCA9IHRoaXMuYXJnRGF0YUlkIHx8IHVybFBhcmFtKCdkYXRhSWQnKQ0KICAgICAgdGhpcy5tb2QgPSB0aGlzLmFyZ01vZCB8fCB1cmxQYXJhbSgnbW9kJykNCiAgICAgIGlmICghZm9ybUlkKSB7DQogICAgICAgIHRoaXMuZ2V0RGVidWdEYXRhKCkNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICBjb25zdCB1cmwgPSAnL2FwaS5wYWdlLmRlc2lnbi5mb3JtL2xvYWRGb3JtSW5mbycNCiAgICAgIGF4aW9zLnBvc3QodXJsLCB7IGZvcm1JZCwgZGF0YUlkIH0pDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHJlcy5kYXRhKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScgJiYgcmVzLmRhdGEuY29kZS5pbmRleE9mKCcwMDAwMCcpID49IDApIHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5kYXRhIHx8IHt9DQogICAgICAgICAgICB0aGlzLmZvcm1JbmZvID0gZGF0YS5mb3JtIHx8IHt9DQogICAgICAgICAgICBjb25zdCBqc29uRGVmaW5lID0gdGhpcy5mb3JtSW5mby5qc29uRGVmaW5lDQogICAgICAgICAgICBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKEJhc2U2NC5kZWNvZGUoanNvbkRlZmluZSkpDQogICAgICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZw0KDQogICAgICAgICAgICAvLyDmjIflrprooajljZXmlbDmja4NCiAgICAgICAgICAgIGlmICh0aGlzLmFyZ0Zvcm1EYXRhICYmIEpTT04uc3RyaW5naWZ5KHRoaXMuYXJnRm9ybURhdGEpICE9PSAne30nKSB7DQogICAgICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSBjbG9uZURlZXAodGhpcy5hcmdGb3JtRGF0YSkNCiAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICghY29uZmlnLmxvYWRBcGkpIHsNCiAgICAgICAgICAgICAgdGhpcy5kZWZhdWx0QXBpSGFuZGxlcihkYXRhKQ0KICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuY3VzdG9tQXBpSGFuZGxlcihjb25maWcpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycikgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycikNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIGdldERlYnVnRGF0YSAoKSB7DQogICAgICBheGlvcy5nZXQoJ2h0dHBzOi8vYXBpLm1vY2suc21hbGxzYWFzLmNuL2Zvcm0nKQ0KICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgdGhpcy5jb25maWcgPSByZXMuZGF0YQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpDQogICAgICAgIH0pDQogICAgfSwNCiAgICBkZWZhdWx0QXBpSGFuZGxlciAoZGF0YSkgew0KICAgICAgY29uc3QgZm9ybURhdGEgPSB7fQ0KICAgICAgT2JqZWN0LmtleXMoKGRhdGEuZm9ybURhdGEgfHwge30pKS5mb3JFYWNoKGtleSA9PiB7DQogICAgICAgIGNvbnN0IF9rZXkgPSBrZXkudG9Mb3dlckNhc2UoKQ0KICAgICAgICBmb3JtRGF0YVtfa2V5XSA9IGRhdGEuZm9ybURhdGFba2V5XQ0KICAgICAgfSkNCiAgICAgIHRoaXMuZm9ybURhdGEgPSBmb3JtRGF0YQ0KICAgIH0sDQogICAgY3VzdG9tQXBpSGFuZGxlciAoY29uZmlnKSB7DQogICAgICBheGlvcy5nZXQoY29uZmlnLmxvYWRBcGkpLnRoZW4ocnMgPT4gew0KICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHJzLmRhdGEpID09PSAnW29iamVjdCBPYmplY3RdJyAmJiBycy5kYXRhLmNvZGUgPT09ICcwMDAwMDAnKSB7DQogICAgICAgICAgdGhpcy5mb3JtRGF0YSA9IHJzLmRhdGEuZGF0YSB8fCB7fQ0KICAgICAgICB9DQogICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKGVycikNCiAgICAgIH0pDQogICAgfSwNCiAgICBnZXRGb3JtRGF0YSAoKSB7DQogICAgICByZXR1cm4gdGhpcy4kcmVmcy5oNUZvcm1QYXJzZXJDb21wUmVmLmdldFN1Ym1pdERhdGEoKQ0KICAgIH0sDQogICAgc3VibWl0IChmb3JtLCBjYikgew0KICAgICAgdGhpcy4kZW1pdCgnc3VibWl0JywgZm9ybSwgY2IpDQogICAgfSwNCiAgICBPblN1Ym1pdEZvcm1TdWMgKCkgew0KICAgICAgdGhpcy4kZW1pdCgnT25TdWJtaXRGb3JtU3VjJykNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/parser","sourcesContent":["<template>\r\n  <div class=\"form-container\">\r\n    <Parser\r\n      :config=\"config\"\r\n      :form-info=\"formInfo\"\r\n      :srv-form-data=\"formData\"\r\n      :if-manual-submit=\"ifManualSubmit\"\r\n      @submit=\"submit\"\r\n      @OnSubmitFormSuc=\"OnSubmitFormSuc\"\r\n      ref=\"h5FormParserCompRef\"\r\n      v-if=\"mod !== 'preview'\"\r\n    />\r\n    <Preview\r\n      v-if=\"mod === 'preview'\"\r\n      :config=\"config\"\r\n      :srv-form-data=\"formData\"\r\n    />\r\n  </div>\r\n</template>\r\n<script>\r\nimport Parser from '../../components/Parser'\r\nimport Preview from '../../components/Preview'\r\nimport { urlParam, Base64 } from '@/utils'\r\n// import { config } from '@/config'\r\nimport axios from 'axios'\r\nimport cloneDeep from 'lodash.clonedeep'\r\nexport default {\r\n  name: 'H5FormRender',\r\n  props: {\r\n    // 表单id\r\n    argFormId: String,\r\n    // 表单数据id\r\n    argDataId: String,\r\n    // 表单数据\r\n    argFormData: {\r\n      type: Object,\r\n      default () {\r\n        return null\r\n      }\r\n    },\r\n    // 是否手动提交\r\n    ifManualSubmit: Boolean,\r\n    argMod: String, // 默认编辑 edit: 编辑  preview: 预览\r\n  },\r\n  components: {\r\n    Parser,\r\n    Preview\r\n  },\r\n  data () {\r\n    return {\r\n      config: {},\r\n      formInfo: {},\r\n      formData: {},\r\n      mod: 'edit'\r\n    }\r\n  },\r\n  created () {\r\n    this.initData()\r\n  },\r\n  methods: {\r\n    initData () {\r\n      const formId = this.argFormId || urlParam('id')\r\n      const dataId = this.argDataId || urlParam('dataId')\r\n      this.mod = this.argMod || urlParam('mod')\r\n      if (!formId) {\r\n        this.getDebugData()\r\n        return\r\n      }\r\n      const url = '/api.page.design.form/loadFormInfo'\r\n      axios.post(url, { formId, dataId })\r\n        .then((res) => {\r\n          if (Object.prototype.toString.call(res.data) === '[object Object]' && res.data.code.indexOf('00000') >= 0) {\r\n            const data = res.data.data || {}\r\n            this.formInfo = data.form || {}\r\n            const jsonDefine = this.formInfo.jsonDefine\r\n            const config = JSON.parse(Base64.decode(jsonDefine))\r\n            this.config = config\r\n\r\n            // 指定表单数据\r\n            if (this.argFormData && JSON.stringify(this.argFormData) !== '{}') {\r\n              this.formData = cloneDeep(this.argFormData)\r\n              return\r\n            }\r\n\r\n            if (!config.loadApi) {\r\n              this.defaultApiHandler(data)\r\n              return\r\n            }\r\n            this.customApiHandler(config)\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    getDebugData () {\r\n      axios.get('https://api.mock.smallsaas.cn/form')\r\n        .then((res) => {\r\n          this.config = res.data\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n    defaultApiHandler (data) {\r\n      const formData = {}\r\n      Object.keys((data.formData || {})).forEach(key => {\r\n        const _key = key.toLowerCase()\r\n        formData[_key] = data.formData[key]\r\n      })\r\n      this.formData = formData\r\n    },\r\n    customApiHandler (config) {\r\n      axios.get(config.loadApi).then(rs => {\r\n        if (Object.prototype.toString.call(rs.data) === '[object Object]' && rs.data.code === '000000') {\r\n          this.formData = rs.data.data || {}\r\n        }\r\n      }).catch((err) => {\r\n        console.log(err)\r\n      })\r\n    },\r\n    getFormData () {\r\n      return this.$refs.h5FormParserCompRef.getSubmitData()\r\n    },\r\n    submit (form, cb) {\r\n      this.$emit('submit', form, cb)\r\n    },\r\n    OnSubmitFormSuc () {\r\n      this.$emit('OnSubmitFormSuc')\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n</style>\r\n"]}]}